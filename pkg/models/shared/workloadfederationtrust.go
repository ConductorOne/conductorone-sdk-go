// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package shared

import (
	"github.com/conductorone/conductorone-sdk-go/pkg/utils"
	"time"
)

// WorkloadFederationTrust represents a per-SP trust policy that references
//
//	a tenant-level provider and defines a CEL condition for claim matching.
type WorkloadFederationTrust struct {
	// IP allowlist for token exchange requests matching this trust.
	AllowSourceCidrs []string `json:"allowSourceCidrs,omitempty"`
	// The full client ID of the trust (e.g., "clever-fox-42195@acme.conductorone.com/wfe").
	//  Used as the client_id parameter in RFC 8693 token exchange requests.
	ClientID *string `json:"clientId,omitempty"`
	// CEL expression evaluated against JWT claims. Must return bool.
	//  Example: claims.sub.startsWith("repo:acme/infra:") && claims.environment == "production"
	ConditionExpression *string    `json:"conditionExpression,omitempty"`
	CreatedAt           *time.Time `json:"createdAt,omitempty"`
	// A description of what this trust policy matches.
	Description *string `json:"description,omitempty"`
	// Whether the trust is disabled.
	Disabled *bool `json:"disabled,omitempty"`
	// The display name of the trust.
	DisplayName *string `json:"displayName,omitempty"`
	// JWT claim names from the subject token to copy into the issued C1 token.
	//  Values are placed in the "c1wfc" claim as a map[string]string.
	//  Only string-valued claims are copied; non-string claims are silently skipped.
	//  Example: ["repository", "repository_owner", "job_workflow_ref"]
	PassthroughClaims []string `json:"passthroughClaims,omitempty"`
	// The provider ID this trust references. Immutable after creation.
	ProviderID *string `json:"providerId,omitempty"`
	// Scoped role IDs. Effective permissions = min(SP roles, trust.scoped_role_ids).
	ScopedRoleIds []string `json:"scopedRoleIds,omitempty"`
	// The service principal user ID this trust belongs to.
	ServicePrincipalID *string    `json:"servicePrincipalId,omitempty"`
	UpdatedAt          *time.Time `json:"updatedAt,omitempty"`
}

func (w WorkloadFederationTrust) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(w, "", false)
}

func (w *WorkloadFederationTrust) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &w, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (w *WorkloadFederationTrust) GetAllowSourceCidrs() []string {
	if w == nil {
		return nil
	}
	return w.AllowSourceCidrs
}

func (w *WorkloadFederationTrust) GetClientID() *string {
	if w == nil {
		return nil
	}
	return w.ClientID
}

func (w *WorkloadFederationTrust) GetConditionExpression() *string {
	if w == nil {
		return nil
	}
	return w.ConditionExpression
}

func (w *WorkloadFederationTrust) GetCreatedAt() *time.Time {
	if w == nil {
		return nil
	}
	return w.CreatedAt
}

func (w *WorkloadFederationTrust) GetDescription() *string {
	if w == nil {
		return nil
	}
	return w.Description
}

func (w *WorkloadFederationTrust) GetDisabled() *bool {
	if w == nil {
		return nil
	}
	return w.Disabled
}

func (w *WorkloadFederationTrust) GetDisplayName() *string {
	if w == nil {
		return nil
	}
	return w.DisplayName
}

func (w *WorkloadFederationTrust) GetPassthroughClaims() []string {
	if w == nil {
		return nil
	}
	return w.PassthroughClaims
}

func (w *WorkloadFederationTrust) GetProviderID() *string {
	if w == nil {
		return nil
	}
	return w.ProviderID
}

func (w *WorkloadFederationTrust) GetScopedRoleIds() []string {
	if w == nil {
		return nil
	}
	return w.ScopedRoleIds
}

func (w *WorkloadFederationTrust) GetServicePrincipalID() *string {
	if w == nil {
		return nil
	}
	return w.ServicePrincipalID
}

func (w *WorkloadFederationTrust) GetUpdatedAt() *time.Time {
	if w == nil {
		return nil
	}
	return w.UpdatedAt
}
